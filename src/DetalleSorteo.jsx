import React, { useEffect, useRef, useState } from 'react';
import { useParams } from 'react-router-dom';
import { Box, Typography, Button, List, ListItem, ListItemText, Card, CardContent, Grid, Modal } from '@mui/material';
import Nlayout from './Nlayout';
import axios from 'axios';
import backgroundImg from './main_intro.jpg';
import { motion, AnimatePresence } from 'framer-motion';
import { useAuth } from './authContext';
import io from 'socket.io-client';

const socket = io('https://25a4-54-39-131-40.ngrok-free.app', {
  transports: ['websocket', 'polling'],
});

export default function DetalleSorteo({ sorteos, setSorteos, isMobile }) {
  const { url } = useParams();
  const { username, logout } = useAuth();

  const [sorteo, setSorteo] = useState();
  const [participantes, setParticipantes] = useState();
  const [ganadores, setGanadores] = useState();
  const [unirseSorteo, setUnirseSorteo] = useState();

  // Inicializar userMessageCounts desde localStorage
  const [userMessageCounts, setUserMessageCounts] = useState(() => {
    try {
      const stored = localStorage.getItem('userMessageCounts');
      return stored ? JSON.parse(stored) : {};
    } catch (error) {
      console.error('Error al leer userMessageCounts de localStorage:', error);
      return {};
    }
  });

  const obtenerSorteos = async () => {
    const peticion = await axios.get(`https://backmu.vercel.app/sorteo/${url}`);
    setSorteo(peticion?.data?.sorteo);
    setParticipantes(peticion?.data?.participantes);
  };

  const UnirseAlSorteo = async (nombre, mail) => {
    try {
      const peticion = await axios.post(`https://backmu.vercel.app/sorteo/${url}/unirse`, { nombre, mail });
      const peticionUser = await axios.post(`https://backmu.vercel.app/sorteo/crearUser`, { nombre, mail });

      if (peticion?.data?.success) {
        obtenerSorteos();
      } else {
        setUnirseSorteo(true);
        alert('ERROR YA TE UNISTE');
      }
    } catch (error) {
      setUnirseSorteo(true);
      alert('ERROR YA TE UNISTE');
    }
  };

  useEffect(() => {
    obtenerSorteos();
  }, []);

  const usuario = localStorage.getItem('fbUser')?.replaceAll('"', '');
  const usuarioKick = localStorage.getItem('kick_user');
  const mailKick = localStorage.getItem('kick_mail');

  const unirse = () => {
    const nombre = username;
    const mail = mailKick;
    if (!nombre) return;
    UnirseAlSorteo(nombre, mail);
  };

  const guardarGanadores = async (url, ganadores) => {
    try {
      const response = await axios.put(`https://backmu.vercel.app/sorteo/${url}/ganadores`, {
        ganadores,
      });
      console.log('Ganadores guardados:', response.data);
      return response.data;
    } catch (error) {
      console.error('Error al guardar ganadores:', error);
      throw error;
    }
  };

  const [open, setOpen] = useState();
  const [progress, setProgress] = useState(100);
  const duration = 5000;

  useEffect(() => {
    if (open) {
      setProgress(100);
      let interval = setInterval(() => {
        setProgress((prev) => {
          if (prev <= 0) {
            clearInterval(interval);
            if (open) {
              setOpen(false);
            }
            return 0;
          }
          return prev - 2;
        });
      }, duration / 50);
      return () => clearInterval(interval);
    }
  }, [open]);

  const obtenerGanadoresDelSorteoAnterior = async () => {
    try {
      const response = await fetch(`https://backmu.vercel.app/sorteo/${url}/ganadores-anteriores`);
      const data = await response.json();
      return Array.isArray(data.ganadores) ? data.ganadores : [];
    } catch (err) {
      console.error('Error al obtener la blacklist:', err);
      return [];
    }
  };

  const sortear = async () => {
    const blacklist = await obtenerGanadoresDelSorteoAnterior();
    const participantesValidos = participantes.filter((p) => !blacklist.includes(p.nombre));
    const premiosTotales = sorteo?.premios || 0;
    const shuffledValidos = [...participantesValidos].sort(() => 0.5 - Math.random());
    const ganadoresValidos = shuffledValidos.slice(0, premiosTotales);
    const faltantes = premiosTotales - ganadoresValidos.length;
    let ganadoresCompletos = [...ganadoresValidos];

    if (faltantes > 0) {
      const blacklistParticipando = participantes.filter((p) => blacklist.includes(p.nombre));
      const shuffledBlacklist = [...blacklistParticipando].sort(() => 0.5 - Math.random());
      const ganadoresDeBlacklist = shuffledBlacklist.slice(0, faltantes);
      ganadoresCompletos = [...ganadoresCompletos, ...ganadoresDeBlacklist];
    }

    setGanadores(ganadoresCompletos);
    const nombresGanadores = ganadoresCompletos.map((p) => p.nombre);
    guardarGanadores(url, nombresGanadores);

    if (nombresGanadores.includes(usuarioKick)) {
      setOpen(true);
    }
  };

  useEffect(() => {
    let intervalo;
    let yaMostrado = false;

    const verificarGanador = async () => {
      try {
        const peticion = await axios.get(`https://backmu.vercel.app/sorteo/${url}/ganadores`);
        const data = peticion?.data;

        if (!yaMostrado && data?.some((ganador) => ganador === usuarioKick)) {
          setOpen(true);
          yaMostrado = true;
          clearInterval(intervalo);
        }
      } catch (error) {
        console.error('Error al verificar ganadores', error);
      }
    };

    intervalo = setInterval(verificarGanador, 5000);
    return () => clearInterval(intervalo);
  }, []);

  useEffect(() => {
    obtenerSorteos();
    const interval = setInterval(obtenerSorteos, 5000);
    return () => clearInterval(interval);
  }, [url]);

  const [mousePos, setMousePos] = useState({ x: -100, y: -100 });
  const svgRef = useRef(null);

  const handleMouseMove = (e) => {
    const rect = e.currentTarget.getBoundingClientRect();
    const x = ((e.clientX - rect.left) / rect.width) * 100;
    const y = ((e.clientY - rect.top) / rect.height) * 100;
    setMousePos({ x, y });

    if (svgRef.current) {
      const ellipse = svgRef.current.querySelector('ellipse');
      if (ellipse) {
        ellipse.setAttribute('cx', `${x}%`);
        ellipse.setAttribute('cy', `${y}%`);
      }
    }
  };

  const handleMouseLeave = () => {
    setMousePos({ x: -100, y: -100 });
    if (svgRef.current) {
      const ellipse = svgRef.current.querySelector('ellipse');
      if (ellipse) {
        ellipse.setAttribute('cx', '1.25%');
        ellipse.setAttribute('cy', '82.24121557454892%');
      }
    }
  };

  // Guardar userMessageCounts en localStorage
  useEffect(() => {
    try {
      if (Object.keys(userMessageCounts).length > 0) {
        localStorage.setItem('userMessageCounts', JSON.stringify(userMessageCounts));
      }
    } catch (error) {
      console.error('Error al guardar userMessageCounts en localStorage:', error);
    }
  }, [userMessageCounts]);

  const handleChatMessage = ({ username }) => {
    console.log('Nuevo mensaje de chat:', username);
    setUserMessageCounts((prev) => ({
      ...prev,
      [username]: (prev[username] || 0) + 1,
    }));
  };

  const getUserColor = (messageCount) => {
    if (messageCount >= 200) return { color: '#ff0000cc', bonus: 10 }; // Rojo (+10%)
    if (messageCount >= 150) return { color: '#ed6e07cc', bonus: 8 }; // Naranja (+8%)
    if (messageCount >= 100) return { color: '#bec800cc', bonus: 6 }; // Amarillo (+6%)
    if (messageCount >= 70) return { color: '#33e64bcc', bonus: 4 }; // Verde Claro (+4%)
    if (messageCount >= 30) return { color: '#008a13cc', bonus: 2 }; // Verde Oscuro (+2%)
    return { color: 'black', bonus: 0 }; // Default (sin bonus)
  };

  useEffect(() => {
    socket.on('nuevo-mensaje', handleChatMessage);
    return () => {
      socket.off('nuevo-mensaje', handleChatMessage);
    };
  }, []);

  return (
    <Nlayout>
      <Grid className="backgroundAnimado" onMouseMove={handleMouseMove} onMouseLeave={handleMouseLeave}>
        {/* SVG como fondo */}
        <svg ref={svgRef}
                    xmlns="http://www.w3.org/2000/svg"
                    width="1920"
                    height="1234"
                    fill="none"
                    style={{ position: 'absolute', top: 0, left: 0, width: '100%', height: '100%', objectFit: 'cover', zIndex: -1 }}
                    className="highlight-block-bg leaderboard-intro-bg">
                    <defs>
                        <radialGradient id="leaderboard_intro_bg_svg__a" cx="0" cy="0" r="1" gradientTransform="rotate(90 452.72 546.22) scale(1141.5)" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#fff"></stop>
                            <stop offset="1" stop-color="#fff"></stop>
                        </radialGradient>
                        <radialGradient id="leaderboard_intro_bg_svg__b" cx="50%" cy="50%" r="50%">
                            <stop offset="0%" stop-color="rgba(100, 100, 100, 1)"></stop>
                            <stop offset="100%" stop-color="rgba(0, 0, 0, 0)"></stop>
                        </radialGradient>
                        <radialGradient id="leaderboard_intro_bg_svg__d" cx="50%" cy="50%" r="50%">
                            <stop offset="0%" stop-color="rgba(20, 20, 20, 0.5)"></stop>
                            <stop offset="100%" stop-color="rgba(20, 20, 20, 0.5)"></stop>
                        </radialGradient>
                        <clipPath id="leaderboard_intro_bg_svg__c">
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="m245.312-362.265-84.854-84.853-28.284 28.284-32.526-32.526 89.095-89.095 32.526 32.526-28.284 28.284 84.853 84.853-32.526 32.527Zm-84.854-93.337 84.854 84.853 24.042-24.042-84.854-84.853 28.284-28.284-24.042-24.042-80.61 80.61 24.042 24.042 28.284-28.284ZM261.712-527.035 155.768-632.979l32.526-32.526 105.944 105.944-32.526 32.526Zm-97.46-105.944 97.46 97.46 24.042-24.042-97.46-97.46-24.042 24.042ZM629.1-660.236l-32.526-32.526 117.378-117.38 32.526 32.526L629.1-660.236Zm-24.042-32.527 24.042 24.042 108.894-108.894-24.042-24.042-108.894 108.894ZM-39.453 508.172l-32.527-32.527L45.4 358.266l32.526 32.527-117.379 117.379Zm-24.043-32.527 24.043 24.043L69.442 390.793 45.4 366.75-63.496 475.645ZM1414.35 1107.77l-32.53-32.53 86.82-86.819-52.32-52.326-56.57 56.568-32.53-32.527 89.1-89.094 84.85 84.852 24.04-24.041-84.85-84.854 32.53-32.527 84.85 84.853 24.04-24.041-84.85-84.854 32.53-32.527 117.37 117.381-28.28 28.283 72.4 72.404L1793.33 873.6l32.52 32.527-134.9 134.893-104.93-104.927-24.04 24.041 84.85 84.856-32.52 32.52-84.85-84.849-115.11 115.109Zm-24.04-32.53 24.04 24.04 115.1-115.102 84.86 84.852 24.04-24.04-84.86-84.855 32.53-32.525 104.93 104.93 126.42-126.412-24.05-24.043-102.37 102.371-80.89-80.889 28.29-28.283-108.9-108.896-24.04 24.043 84.85 84.854-32.52 32.525-84.86-84.854-24.04 24.043 84.86 84.854-32.53 32.525-84.85-84.852-80.61 80.609 24.04 24.043 56.57-56.568 60.81 60.811-86.82 86.819ZM471.859 1001.88 354.48 884.494l28.284-28.283-52.326-52.326-56.569 56.568-32.526-32.527 89.096-89.094 84.853 84.852 24.042-24.041-61.062-61.063 32.526-32.525 61.062 61.061 136.318-136.318 32.526 32.527L532.67 771.357l52.326 52.326 56.569-56.568 32.526 32.527-89.096 89.094-84.852-84.852-24.042 24.041 84.853 84.853-32.526 32.527-84.853-84.853-24.041 24.041 84.852 84.854-32.527 32.533ZM362.965 884.494 471.86 993.39l24.042-24.043-84.854-84.854 32.527-32.525 84.853 84.853 24.042-24.043-84.853-84.853 32.526-32.525 84.852 84.852 80.611-80.609-24.042-24.043-56.569 56.568-60.81-60.811 108.034-108.033-24.042-24.043L471.859 775.6l-61.062-61.061-24.042 24.041 61.062 61.063-32.526 32.525-84.853-84.852-80.611 80.609 24.042 24.043 56.569-56.568 60.811 60.811-28.284 28.283ZM840.17 283.479l-32.527-32.525 150.461-150.46-52.326-52.327-42.427 42.427-32.526-32.526 74.953-74.953 84.853 84.853 24.039-24.042-58.112-58.114 32.526-32.526L1047.2 11.4l24.04-24.042-86.68-86.68 32.53-32.526 119.2 119.206-28.28 28.284 24.04 24.041 198.4-198.401 32.53 32.526-230.93 230.93-56.57-56.568-24.04 24.042 84.85 84.853-32.52 32.526-84.86-84.851-178.74 178.739Zm-24.041-32.526 24.041 24.041 178.74-178.743 84.86 84.853 24.04-24.042-84.85-84.853 32.52-32.528 56.57 56.57 222.45-222.445-24.05-24.042-198.4 198.403-32.52-32.527 28.28-28.284-110.72-110.722-24.046 24.043 86.676 86.68-32.52 32.525-58.116-58.114-24.042 24.042 58.118 58.114-32.529 32.529-84.853-84.856-66.469 66.47 24.042 24.041 42.427-42.428 60.81 60.813-150.459 150.46ZM1142.1-620.959l-32.53-32.526 37.33-37.323-24.05-24.041-56.56 56.567-32.53-32.526 89.1-89.095 56.56 56.568 24.04-24.042-98.99-98.995 32.53-32.527 98.99 98.996 24.04-24.042-56.57-56.569 32.53-32.526 89.1 89.096-28.29 28.284 52.33 52.326 42.42-42.427 32.53 32.526-74.95 74.953-84.86-84.852-24.04 24.041 56.57 56.568-32.53 32.526-56.56-56.568-65.61 65.608Zm-24.04-32.526 24.04 24.042 65.61-65.608 56.56 56.569 24.05-24.042-56.57-56.568 32.52-32.526 84.86 84.853 66.47-66.469-24.05-24.042-42.42 42.427-60.81-60.811 28.28-28.284-80.61-80.611-24.04 24.042 56.57 56.569-32.53 32.527-99-98.996-24.04 24.042 99 98.995-32.53 32.526-56.57-56.568-80.61 80.61 24.05 24.042 56.56-56.568 32.53 32.526-37.32 37.323Z"></path>
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="m67.57 913.486-89.096-89.094 84.852-84.854-24.04-24.041-84.854 84.852-32.527-32.525L6.76 682.971-129.56 546.653l32.528-32.524L11.001 622.161l52.326-52.327L6.76 513.266l32.526-32.526 89.095 89.095-84.852 84.853L67.57 678.73l84.852-84.854 32.527 32.527-84.853 84.854 24.042 24.041 84.854-84.853 32.526 32.528-117.38 117.378-28.284-28.283-52.326 52.327 56.569 56.568-32.528 32.523Zm-80.61-89.093 80.61 80.609 24.04-24.04-56.567-56.569 60.811-60.81 28.284 28.282 108.896-108.894-24.042-24.043-84.854 84.853-32.527-32.525 84.854-84.854-24.043-24.043-84.852 84.854-32.526-32.527 84.853-84.853-80.61-80.61-24.042 24.043 56.568 56.567-60.81 60.812-108.034-108.034-24.042 24.041L15.244 682.97l-84.853 84.853 24.042 24.042 84.853-84.853 32.526 32.525-84.853 84.856ZM635.483 1207.44l-82.531-82.53 131.521-131.52 98.994 98.99-67.882 67.89-32.526-32.53 35.355-35.35-33.941-33.95-66.469 66.47 50.005 50.01-32.526 32.52Zm-74.046-82.53 74.047 74.05 24.042-24.04-50.005-50.01 74.953-74.95 42.426 42.43-35.354 35.35 24.041 24.04 59.397-59.39-90.51-90.51-123.037 123.03ZM1489.16 709.793l-82.72-82.71 32.53-32.527 50.19 50.185 33.94-33.94-81.3-81.3-50.01 50.006-32.52-32.527 82.53-82.531 146.35 146.353-98.99 98.991Zm-74.23-82.71 74.23 74.226 90.51-90.51-137.87-137.867-74.05 74.047 24.05 24.043 50-50.006 89.78 89.783-42.42 42.426-50.19-50.186-24.04 24.044ZM1720.91 860.291l-153.24-153.242 199.92-199.92 169.7 169.705-67.88 67.883-32.52-32.527 35.35-35.355-104.65-104.652-134.87 134.867 120.72 120.715-32.53 32.526Zm-144.76-153.242 144.76 144.758 24.04-24.043-120.71-120.715 143.35-143.352 113.14 113.137-35.36 35.355 24.04 24.043 59.4-59.398-161.22-161.221-191.44 191.436ZM1117.1 405.506l-98.99-98.994 67.88-67.882 32.53 32.526-35.36 35.356 33.94 33.941 66.47-66.469-50-50.005 32.52-32.526 82.54 82.531-131.53 131.522Zm-90.51-98.994 90.51 90.51 123.04-123.037-74.05-74.046-24.04 24.041 50.01 50.005-74.96 74.953-42.42-42.426 35.35-35.356-24.04-24.041-59.4 59.397ZM324.756-589.998 193.234-721.52l98.994-98.996 67.883 67.883-32.527 32.526-35.355-35.354-33.942 33.941 66.469 66.469 50.005-50.005 32.526 32.526-82.531 82.532ZM201.719-721.52l123.037 123.037 74.047-74.047-24.042-24.042-50.005 50.005-74.953-74.953 42.426-42.426 35.355 35.355 24.042-24.042-59.397-59.396-90.51 90.509ZM-22.125 1109.24l-32.526-32.52 56.568-56.57-24.042-24.044-56.568 56.564-32.526-32.52 89.095-89.098 89.096 89.098-89.097 89.09Zm-24.042-32.52 24.042 24.04 80.611-80.61-80.61-80.614-80.611 80.614 24.042 24.04 56.568-56.568 32.528 32.528-56.57 56.57ZM1977.88 1109.24l-32.53-32.52 56.57-56.57-24.04-24.044-56.57 56.564-32.53-32.52 89.1-89.098 89.09 89.098-89.09 89.09Zm-24.05-32.52 24.05 24.04 80.61-80.61-80.61-80.614-80.61 80.614 24.04 24.04 56.57-56.568 32.52 32.528-56.57 56.57ZM1050.1 1149.57l-79.823-79.82 89.093-89.098 79.82 79.818-32.52 32.53-47.3-47.29-24.04 24.04 47.3 47.29-32.53 32.53Zm-71.337-79.82 71.337 71.33 24.04-24.04-47.29-47.29 32.52-32.53 47.3 47.3 24.04-24.05-71.34-71.333-80.607 80.613ZM451.97 699.299l-205.269-205.27-24.043 24.043 92.735 92.734-32.527 32.525-125.261-125.26 89.096-89.096L484.496 666.77l-32.526 32.529ZM246.701 485.545 451.97 690.814l24.042-24.043-229.311-229.31-80.611 80.611 116.776 116.776 24.042-24.041-92.734-92.734 32.527-32.528ZM1325.8 158.404l-32.53-32.526 143.53-143.53-24.04-24.041-62.63 62.631-32.53-32.526 95.16-95.158 89.09 89.095-176.05 176.055Zm-24.05-32.526 24.05 24.042 167.57-167.572-80.61-80.61-86.68 86.674 24.05 24.042 62.63-62.632 32.52 32.526-143.53 143.53ZM1458.5-324.751l-32.53-32.527 46.28-46.279-24.04-24.041-82.16 82.162-32.53-32.526 114.69-114.691 89.1 89.096-78.81 78.806Zm-24.04-32.527 24.04 24.042 70.32-70.321-80.61-80.609L1342-377.962l24.05 24.042 82.16-82.164 32.52 32.527-46.27 46.279ZM1339.43-449.146l-129.02-129.025 32.52-32.526 96.5 96.498 24.04-24.042-56.56-56.568 32.52-32.526 89.1 89.095-89.1 89.094Zm-120.54-129.025 120.54 120.541 80.61-80.611-80.61-80.61-24.04 24.042 56.57 56.568-32.53 32.526-96.5-96.498-24.04 24.042ZM184.685-197.877 80.145-302.418l89.094-89.095 89.096 89.095-32.526 32.526-56.569-56.568-24.042 24.042 72.015 72.015-32.528 32.526ZM88.628-302.418l96.057 96.057 24.042-24.042-72.015-72.015 32.526-32.526 56.569 56.568 24.042-24.042-80.611-80.61-80.61 80.61ZM487.678-639.864l-32.526-32.526 84.853-84.853-24.042-24.042-84.853 84.853-32.526-32.526 117.378-117.38 89.096 89.095-117.38 117.379Zm-24.042-32.527 24.042 24.042 108.895-108.894-80.611-80.61-108.895 108.894 24.042 24.042 84.853-84.853 32.526 32.526-84.852 84.853ZM-7.41 370.57l-89.096-89.094 32.526-32.527 29.372 29.374 77.782-77.785 30.351 30.353-77.78 77.781 29.371 29.373L-7.41 370.57Zm-80.61-89.092 80.61 80.608 24.042-24.041-29.372-29.373 77.781-77.781-21.866-21.866-77.782 77.782-29.372-29.373-24.042 24.044ZM1730.23 1211.53l-56.73-56.74-20.76 20.76-32.53-32.53 80.48-80.48 32.53 32.53-29.38 29.37 56.74 56.73-30.35 30.36Zm-56.74-65.22 56.74 56.73 21.86-21.87-56.73-56.73 29.37-29.37-24.04-24.04-71.99 71.99 24.04 24.04 20.75-20.75ZM410.027 1216.35l-89.095-89.09 32.526-32.53 29.372 29.37 77.781-77.78 30.351 30.36-77.781 77.78 29.371 29.37-32.525 32.52Zm-80.61-89.09 80.61 80.61 24.042-24.04-29.373-29.37 77.783-77.79-21.867-21.86-77.781 77.78-29.372-29.37-24.042 24.04ZM882.201 1142.45l-130.889-130.89 66.638-66.641 32.526 32.528-34.111 34.113 98.362 98.36-32.526 32.53Zm-122.404-130.89 122.404 122.4 24.042-24.04-98.362-98.36 34.111-34.112-24.042-24.042-58.153 58.154ZM952.238-133.342 848.21-237.37l-54.197 54.197-32.526-32.526 86.724-86.724 136.554 136.554-32.527 32.527ZM848.21-245.854l104.028 104.027 24.041-24.042L848.21-293.938l-78.239 78.239 24.042 24.042 54.197-54.197ZM577.283 200.265 397.429 20.41l88.503-88.503 32.526 32.526-55.977 55.977L609.81 167.738l-32.527 32.527ZM405.913 20.41l171.37 171.371 24.042-24.043L453.997 20.41l55.977-55.977-24.042-24.042-80.019 80.02ZM1757.33-496.237l-49.5-49.497-14.14 14.143-32.53-32.527 46.67-46.669 82.03 82.024-32.53 32.526Zm-49.5-57.984 49.5 49.499 24.04-24.042-73.54-73.54-38.18 38.185 24.04 24.041 14.14-14.143ZM405.504-317.482l-67.882-67.882 32.526-32.526 35.356 35.355 28.284-28.284 32.526 32.526-60.81 60.811Zm-59.398-67.882 59.398 59.397 52.326-52.326-24.042-24.042-28.284 28.284-35.356-35.355-24.042 24.042ZM545.786-62.885 513.26-95.41l156.41-156.411-28.283-28.284 32.526-32.528 60.811 60.813L545.786-62.885ZM521.744-95.41l24.042 24.043 180.452-180.454-52.325-52.326-24.042 24.042 28.284 28.284L521.744-95.411ZM496.144-416.531l-55.331-55.331-40.871 40.872-32.526-32.526 73.398-73.398 87.857 87.857-32.527 32.526Zm-55.331-63.816 55.331 55.331 24.042-24.042-79.373-79.373-64.913 64.914 24.042 24.042 40.871-40.872Z"></path>
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="m1124.86 975.455-32.53-32.527 109.57-109.563 49.49 49.496 24.04-24.041-192.33-192.334 216.24-216.236 32.53 32.527-183.72 183.709 159.81 159.807 84.85-84.854-98.99-98.994-24.04 24.041 70.71 70.712-32.53 32.526-103.23-103.238 89.09-89.094 164.05 164.047-206.48 206.474-49.49-49.496-77.04 77.038Zm-24.04-32.527 24.04 24.043 77.03-77.037 49.5 49.497 197.99-197.991-155.56-155.563-80.61 80.609 94.75 94.754 24.04-24.042-70.71-70.712 32.53-32.524 107.48 107.477-93.34 93.338-168.29-168.291 183.71-183.709-24.04-24.043-207.75 207.752 192.33 192.334-32.53 32.525-49.5-49.496-101.07 101.079ZM1617.82 580.121l-89.1-89.095 32.53-32.527 56.57 56.569 205.25-205.254-84.85-84.852-144.45 144.44 24.05 24.043 102.43-102.435 32.53 32.526-134.96 134.961-89.1-89.096 209.5-209.494 206.47 206.475-94.94 94.943 28.28 28.285-32.52 32.525-60.81-60.811 94.94-94.943-24.04-24.041-237.78 237.781Zm-80.61-89.095 80.61 80.61 237.78-237.778 32.52 32.524-94.94 94.943 52.33 52.326 24.04-24.041-28.29-28.285 94.95-94.943-197.99-197.989-201.01 201.009 80.61 80.611 126.47-126.476-24.04-24.042-102.43 102.434-32.53-32.527 152.93-152.924 93.33 93.336-213.73 213.738-56.57-56.569-24.04 24.043ZM800.718 191.221 618.167 8.671l-24.042 24.041 71.615 71.616-32.526 32.526L529.072 32.712l206.475-206.475L871.311-37.998l-89.095 89.095-74.953-74.953 32.526-32.526 42.427 42.426 24.042-24.042-70.711-70.711-84.853 84.854 150.024 150.023 28.284-28.285 32.526 32.528-60.81 60.81ZM618.167.186l182.551 182.551 52.326-52.326-24.042-24.042-28.284 28.284L642.209-23.856l93.338-93.338 79.195 79.195L782.216-5.47l-42.427-42.428-24.042 24.042 66.469 66.47 80.61-80.61-127.279-127.281-197.99 197.99 95.657 95.658 24.042-24.042-71.615-71.616L618.167.186ZM1014.32-199.637 807.842-406.111l87.159-87.159-28.284-28.284 32.526-32.526 60.811 60.81-87.159 87.159 24.042 24.042 164.053-164.049 89.09 89.095-32.52 32.527-56.57-56.569-131.526 131.522 84.856 84.854 70.71-70.711-24.04-24.042-49.5 49.497-32.526-32.526 82.026-82.024 89.09 89.096-135.76 135.762ZM816.326-406.111l197.994 197.99L1141.6-335.4l-80.61-80.611-73.542 73.54 24.042 24.042 49.5-49.497 32.52 32.526-79.19 79.195-93.34-93.338 140.01-140.007 56.57 56.568 24.04-24.042-80.61-80.61-164.052 164.049-32.526-32.526 87.159-87.159-52.327-52.326-24.042 24.042 28.284 28.284-87.16 87.159ZM-7.81 194.232-214.285-12.243l49.497-49.497-28.284-28.285 32.526-32.526 60.811 60.812-49.497 49.497L-125.19 11.8 67.144-180.533 169.996-77.68 137.47-45.154 67.144-115.48-92.663 44.326-7.81 129.18l98.995-98.995L67.143 6.143l-70.71 70.71-32.527-32.525L67.144-58.912l89.095 89.096L-7.81 194.232ZM-205.8-12.242l197.99 197.99L147.754 30.185l-80.61-80.61-94.753 94.752L-3.567 68.37 67.144-2.343 99.67 30.185-7.81 137.664l-93.338-93.338L67.144-123.965l70.326 70.327 24.042-24.043-94.368-94.368-192.333 192.333-32.526-32.526 49.497-49.497-52.326-52.327-24.042 24.042 28.284 28.285-49.498 49.497ZM1992.19 194.232 1785.71-12.243l49.5-49.497-28.28-28.285 32.52-32.526 60.82 60.812-49.5 49.497 24.04 24.041 192.33-192.332L2170-77.68l-32.53 32.526-70.32-70.326-159.81 159.808 84.85 84.852 99-98.995-24.04-24.042-70.72 70.71-32.52-32.525L2067.15-58.91l89.09 89.095-164.05 164.046ZM1794.2-12.242l197.99 197.99 155.56-155.563-80.61-80.61-94.75 94.752 24.04 24.042 70.71-70.712 32.53 32.528-107.48 107.479-93.34-93.338 168.29-168.291 70.33 70.325 24.04-24.04-94.37-94.369-192.33 192.333-32.52-32.526 49.49-49.497-52.32-52.327-24.05 24.042 28.29 28.285-49.5 49.497ZM314.482-408.618l-60.811-60.812 182.025-182.025 32.526 32.526-149.497 149.498 28.284 28.284-32.527 32.529Zm0-8.486 24.042-24.043-28.284-28.284L459.739-618.93l-24.042-24.042-173.541 173.541 52.326 52.327ZM1578.53-637.021 1478.55-737l99.98-99.979 32.53 32.526L1543.61-737l67.45 67.452-32.53 32.527ZM1487.04-737l91.49 91.494 24.04-24.042L1535.12-737l67.45-67.452-24.04-24.042L1487.04-737ZM545.641-176.463l-114.12-114.12 32.526-32.528 81.594 81.596 39.168-39.168 32.526 32.526-71.694 71.694Zm-105.636-114.12 105.636 105.636 63.21-63.21-24.042-24.042-39.168 39.168-81.594-81.595-24.042 24.043ZM1578.53 1362.98l-99.98-99.98 99.98-99.98 32.53 32.53-67.45 67.45 67.45 67.45-32.53 32.53Zm-91.49-99.98 91.49 91.49 24.04-24.04-67.45-67.45 67.45-67.45-24.04-24.04-91.49 91.49ZM1420.13 1228.85l-191.2-191.2 32.52-32.53 158.68 158.67 71.89-71.89 32.53 32.52-104.42 104.43Zm-182.72-191.2 182.72 182.71 95.94-95.94-24.05-24.04-71.89 71.9-158.68-158.68-24.04 24.05ZM225.003 1175.61l-121.839-121.83 32.526-32.53 89.313 89.31 152.661-152.659 32.526 32.525-185.187 185.184Zm-113.355-121.83 113.355 113.35 176.703-176.704-24.042-24.041-152.661 152.665-89.313-89.32-24.042 24.05ZM1008.18 730.773l-84.382-84.383 99.982-99.978 32.52 32.527-67.448 67.451 51.858 51.855-32.53 32.528Zm-75.898-84.382 75.898 75.898 24.04-24.043-51.854-51.855 67.454-67.451-24.05-24.043-91.488 91.494ZM558.869 433.33l-84.832-84.834 32.526-32.525 52.306 52.305 67.452-67.451 32.526 32.528-99.978 99.977Zm-76.348-84.834 76.348 76.35 91.494-91.493-24.042-24.044-67.452 67.451-52.306-52.305-24.042 24.041Z"></path>
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="m1175.74-361.151-32.53-32.526 67.45-67.451-87.68-87.68 32.53-32.526 120.2 120.206-99.97 99.977Zm-24.05-32.527 24.05 24.042 91.49-91.493-111.72-111.722-24.04 24.042 87.68 87.68-67.46 67.451ZM187.984-96.727l-99.979-99.978 32.526-32.526 67.452 67.451 52.004-52.004 32.526 32.526-84.529 84.531ZM96.49-196.705l91.494 91.494 76.046-76.047-24.042-24.042-52.004 52.004-67.452-67.451-24.042 24.042ZM131.725-657.021 31.747-757l99.978-99.979 32.527 32.526L96.8-757l67.452 67.452-32.527 32.527ZM40.231-757l91.493 91.494 24.042-24.042L88.316-757l67.45-67.452-24.042-24.042L40.231-757ZM16.726-288.405l-99.979-99.979 99.98-99.979 32.525 32.526-67.452 67.453 67.452 67.452-32.526 32.527Zm-91.495-99.979 91.494 91.494 24.042-24.042-67.452-67.452 67.452-67.452-24.042-24.042-91.494 91.494ZM-22-678.549l-32.526-32.526L-22-743.602l32.526 32.526L-22-678.549Zm-24.042-32.526L-22-687.033l24.042-24.042L-22-735.117l-24.042 24.042ZM1978-678.549l-32.53-32.526 32.53-32.527 32.53 32.526-32.53 32.527Zm-24.04-32.526 24.04 24.042 24.04-24.042-24.04-24.042-24.04 24.042ZM346.363 707.826l-32.526-32.527 32.526-32.525 32.526 32.525-32.526 32.527Zm-24.042-32.527 24.042 24.043 24.042-24.043-24.042-24.041-24.042 24.041ZM792.2 1196.53 759.674 1164l32.526-32.52 32.527 32.52-32.527 32.53ZM768.158 1164l24.042 24.04 24.042-24.04-24.042-24.04-24.042 24.04ZM910.485 946.783l-32.526-32.524 32.526-32.528 32.526 32.528-32.526 32.524Zm-24.042-32.524 24.042 24.04 24.042-24.04-24.042-24.044-24.042 24.044ZM1699.08 936.348l-32.52-32.527 32.52-32.525 32.53 32.525-32.53 32.527Zm-24.04-32.528 24.04 24.043 24.04-24.043-24.04-24.041-24.04 24.041ZM75.067 1128.53l-32.526-32.52 32.526-32.53 32.526 32.53-32.526 32.52Zm-24.042-32.52 24.042 24.04 24.042-24.04-24.042-24.05-24.042 24.05ZM371.707 495.813l-93.989-93.99 32.526-32.525 93.989 93.988-32.526 32.527Zm-85.505-93.991 85.505 85.506 24.042-24.043-85.505-85.504-24.042 24.041ZM378.625 372.146l-32.526-32.527 69.032-69.034 32.526 32.528-69.032 69.033Zm-24.042-32.529 24.042 24.044 60.548-60.55-24.042-24.043-60.548 60.549ZM1179.88 1039.21l-32.52-32.52 57.52-57.532 32.53 32.525-57.53 57.527Zm-24.04-32.52 24.04 24.04 49.05-49.046-24.05-24.041-49.04 49.047ZM89.156 1004.26 56.63 971.733l69.032-69.031 32.528 32.525-69.034 69.033Zm-24.042-32.528 24.042 24.043 60.548-60.549-24.042-24.041-60.548 60.547ZM223.843 803.092l-32.526-32.527 69.032-69.031 32.526 32.525-69.032 69.033Zm-24.042-32.528 24.042 24.043 60.548-60.549-24.042-24.041-60.548 60.547ZM103.89 364.828l-32.526-32.526 63.134-63.134 32.526 32.527-63.134 63.133Zm-24.042-32.526 24.042 24.042 54.649-54.647-24.042-24.044-54.649 54.649ZM-22.007 1235.24l-32.526-32.52 71.098-71.1 32.527 32.53-71.099 71.09Zm-24.042-32.52 24.042 24.04 62.613-62.61-24.042-24.05-62.613 62.62ZM1977.99 1235.24l-32.52-32.52 71.1-71.1 32.52 32.53-71.1 71.09Zm-24.04-32.52 24.04 24.04 62.62-62.61-24.05-24.05-62.61 62.62ZM946.802 1217.48l-32.526-32.52 63.134-63.14 32.53 32.53-63.138 63.13Zm-24.042-32.52 24.042 24.04 54.648-54.65-24.041-24.04-54.649 54.65ZM926.426-38.184 825.988-138.622l32.526-32.526L958.952-70.71l-32.526 32.526Zm-91.953-100.438 91.953 91.954 24.042-24.042-91.953-91.954-24.042 24.042ZM1663.97-289.264l-32.53-32.526 32.53-32.526 32.53 32.526-32.53 32.526Zm-24.04-32.526 24.04 24.042 24.04-24.042-24.04-24.042-24.04 24.042ZM1610.93-3.812l-32.53-32.526 32.53-32.526 32.53 32.526-32.53 32.526Zm-24.04-32.526 24.04 24.042 24.04-24.042-24.04-24.042-24.04 24.042ZM1682.21 162.612l-32.53-32.526 32.53-32.526 32.52 32.526-32.52 32.526Zm-24.04-32.526 24.04 24.042 24.04-24.042-24.04-24.042-24.04 24.042ZM1501.99 465.078l-32.52-32.527 32.52-32.525 32.53 32.525-32.53 32.527Zm-24.04-32.527 24.04 24.043 24.05-24.043-24.05-24.041-24.04 24.041ZM1738.54 723.135l-32.52-32.525 65.39-65.397 32.53 32.525-65.4 65.397Zm-24.04-32.526 24.04 24.041 56.91-56.912-24.04-24.041-56.91 56.912ZM1874.36-332.867l-32.53-32.526 32.53-32.526 32.53 32.526-32.53 32.526Zm-24.04-32.527 24.04 24.042 24.04-24.042-24.04-24.042-24.04 24.042ZM1723.47-348.762l-32.53-32.526 60.81-60.811 32.53 32.526-60.81 60.811Zm-24.04-32.526 24.04 24.042 52.33-52.326-24.05-24.042-52.32 52.326ZM397.102-39.396l-32.526-32.526 64.711-64.713 32.526 32.528-64.711 64.711ZM373.06-71.922l24.042 24.042 56.227-56.227-24.042-24.042-56.227 56.227ZM1086.99-560.157l-32.52-32.528 32.52-32.526 32.53 32.526-32.53 32.528Zm-24.04-32.529 24.04 24.042 24.04-24.042-24.04-24.042-24.04 24.042ZM1304.62-384.8l-32.53-32.526 32.53-32.526 32.52 32.526-32.52 32.526Zm-24.05-32.526 24.05 24.042 24.04-24.042-24.04-24.042-24.05 24.042ZM544.175 307.463l-32.526-32.525 32.526-32.528 32.526 32.528-32.526 32.525Zm-24.042-32.525 24.042 24.041 24.042-24.041-24.042-24.042-24.042 24.042ZM1027.08 231.323l-32.529-32.526 32.529-32.526 32.52 32.526-32.52 32.526Zm-24.04-32.526 24.04 24.042 24.04-24.042-24.04-24.042-24.04 24.042ZM773.436-440.41l-32.526-32.526 52.53-52.531 32.526 32.526-52.53 52.531Zm-24.042-32.527 24.042 24.042 44.046-44.047-24.042-24.042-44.046 44.047ZM1547.98-439.383l-52.53-52.53 32.53-32.526 52.52 52.53-32.52 32.526Zm-44.05-52.53 44.05 44.046 24.04-24.042-44.04-44.046-24.05 24.042Z"></path>
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="m75.647-362.223-32.526-32.526 32.526-32.526 32.526 32.526-32.526 32.526Zm-24.042-32.526 24.042 24.042 24.042-24.042-24.042-24.042-24.042 24.042ZM71.735-478.199l-197.989-197.99-52.326 52.326 56.568 56.569-32.526 32.526-89.097-89.096 117.381-117.379 197.99 197.99 24.042-24.042-78.095-78.095 32.527-32.525 110.621 110.621-89.096 89.095Zm-197.989-206.475 197.99 197.99 80.61-80.61L50.21-669.431l-24.042 24.042 78.096 78.095-32.528 32.526-197.989-197.99-108.894 108.895 80.61 80.61 24.042-24.041-56.568-56.569 60.809-60.811ZM666.944 625.996l-117.38-117.381 197.99-197.988-80.583-80.583-38.303 38.302-32.526-32.526 70.829-70.829 145.636 145.637-197.99 197.988 52.327 52.328 29.432-29.434 32.526 32.527-61.958 61.959ZM558.049 508.615l108.896 108.897 53.474-53.475-24.042-24.043-29.432 29.434-60.812-60.813 197.99-197.988-137.151-137.151-62.345 62.344 24.042 24.042 38.303-38.302 89.067 89.067-197.99 197.988ZM1472.19-119.007l-201.45-201.446-52.32 52.326 75.41 75.411-32.53 32.526-107.94-107.938 117.38-117.379 201.45 201.445 24.04-24.041-56.57-56.568 32.53-32.526 89.09 89.095-89.09 89.095Zm-201.45-209.93 201.45 201.446 80.61-80.61-80.61-80.61-24.04 24.042 56.56 56.568-32.52 32.527-201.45-201.447-108.89 108.894 99.45 99.453 24.04-24.042-75.41-75.411 60.81-60.81ZM711.071-502.841l-89.095-89.095 117.379-117.38 96.444 96.444 24.042-24.042-35.434-35.434 32.526-32.526 67.96 67.96-89.093 89.096-96.444-96.444-52.326 52.327 56.568 56.568-32.527 32.526Zm-80.61-89.095 80.61 80.61 24.042-24.042-56.568-56.568 60.81-60.812 96.444 96.445 80.61-80.61-59.476-59.476-24.042 24.042 35.434 35.434-32.525 32.526-96.444-96.444-108.895 108.895ZM225.258 1047.86l-60.811-60.814 32.526-32.527 28.284 28.285 24.042-24.043-84.853-84.852 32.526-32.527 117.379 117.379-89.093 89.099Zm-52.326-60.813 52.326 52.323 80.61-80.608-108.895-108.895-24.042 24.043 84.853 84.852-32.526 32.527-28.284-28.285-24.042 24.043ZM981.943 876.148l-89.096-89.096 60.811-60.811 32.527 32.525-28.284 28.286 24.042 24.041 84.857-84.853 32.52 32.526-117.377 117.382Zm-80.611-89.095 80.611 80.611 108.897-108.896-24.05-24.04-84.848 84.851-32.528-32.525 28.285-28.284-24.042-24.041-52.325 52.324ZM1147.25-46.154l-80.18-80.179 32.52-32.526 47.66 47.651 24.04-24.041-84.86-84.853 32.53-32.528 117.38 117.381-89.09 89.095Zm-71.7-80.179 71.7 71.695 80.61-80.611-108.9-108.895-24.04 24.042 84.85 84.853-32.52 32.526-47.66-47.652-24.04 24.042ZM211.665 281.188 94.286 163.809l89.095-89.097 60.811 60.812-32.526 32.526-28.284-28.284-24.042 24.042 84.853 84.854-32.528 32.526ZM102.771 163.809l108.894 108.895 24.042-24.041-84.853-84.854 32.526-32.526 28.284 28.284 24.042-24.042-52.326-52.326-80.609 80.61ZM544.945 1064.28l-32.526-32.53L681.38 862.787l42.427 42.426 35.356-35.355 32.526 32.527-67.882 67.881-42.427-42.426-136.435 136.44Zm-24.042-32.53 24.042 24.04 136.434-136.435 42.427 42.426 59.398-59.396-24.042-24.043-35.356 35.355-42.427-42.426-160.476 160.479ZM1146.48 544.547l-42.43-42.427-35.35 35.354-32.53-32.525 67.89-67.882 42.42 42.428 88.11-88.108 32.53 32.525-120.64 120.635Zm-42.42-50.912 42.42 42.428 112.15-112.15-24.04-24.041-88.11 88.108-42.42-42.428-59.4 59.398 24.04 24.041 35.36-35.356Z"></path>
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="M899.108 595.471 795.725 492.089l-35.355 35.354-32.526-32.526 67.882-67.882 103.383 103.384L1027.53 402l32.53 32.526-160.952 160.945ZM795.726 483.604l103.383 103.384 152.461-152.462-24.04-24.042-128.421 128.419-103.383-103.385-59.397 59.399 24.042 24.041 35.355-35.354ZM523.848 631.654 407.39 515.197l54.446-54.447-49.184-49.184 32.526-32.527 81.711 81.711-54.447 54.447 83.933 83.932-32.527 32.525ZM415.874 515.197 523.848 623.17l24.041-24.041-83.931-83.932 54.447-54.447-73.226-73.227-24.042 24.043 49.184 49.184-54.447 54.447ZM1409.02 191.203l-32.53-32.526 176.28-176.278 58.21 58.205 42.8-42.8 32.52 32.526-75.32 75.327-58.21-58.204-143.75 143.75Zm-24.04-32.526 24.04 24.042 143.75-143.753 58.21 58.207 66.84-66.843-24.04-24.042-42.8 42.8-58.21-58.204-167.79 167.793ZM1865.02-157.604l-61.97-61.967 42.43-42.426-17.1-17.103 32.52-32.526 49.63 49.629-42.42 42.426 29.44 29.441-32.53 32.526Zm-53.48-61.966 53.48 53.482 24.04-24.041-29.44-29.441 42.43-42.426-41.15-41.144-24.04 24.041 17.1 17.103-42.42 42.426ZM954.835-666.833l-98.995-98.995-63.64 63.64-32.526-32.526 96.166-96.166 98.995 98.995 63.645-63.641 32.52 32.527-96.165 96.166Zm-98.995-107.48 98.995 98.995L1042.52-763l-24.04-24.042-63.645 63.64-98.995-98.994-87.682 87.682 24.042 24.041 63.64-63.64ZM629.1 1339.76l-32.526-32.52 117.379-117.38 32.526 32.53L629.1 1339.76Zm-24.042-32.52 24.042 24.04 108.895-108.9-24.042-24.04-108.895 108.9ZM1142.1 1379.04l-32.53-32.53 37.33-37.32-24.05-24.04-56.56 56.57-32.53-32.53 89.1-89.09 56.56 56.56 24.04-24.04-98.99-98.99 32.53-32.53 98.99 99 24.04-24.04-56.57-56.57 32.53-32.53 89.1 89.1-28.29 28.28 52.33 52.33 42.42-42.43 32.53 32.53-74.95 74.95-84.86-84.85-24.04 24.04 56.57 56.57-32.53 32.52-56.56-56.57-65.61 65.61Zm-24.04-32.53 24.04 24.05 65.61-65.61 56.56 56.57 24.05-24.04-56.57-56.57 32.52-32.53 84.86 84.86 66.47-66.47-24.05-24.05-42.42 42.43-60.81-60.81 28.28-28.28-80.61-80.61-24.04 24.04 56.57 56.57-32.53 32.52-99-98.99-24.04 24.04 99 98.99-32.53 32.53-56.57-56.57-80.61 80.61 24.05 24.05 56.56-56.57 32.53 32.52-37.32 37.32ZM324.756 1410l-131.522-131.52 98.994-98.99 67.882 67.88-32.526 32.52-35.355-35.35-33.941 33.94 66.469 66.47 50.005-50.01 32.526 32.53-82.532 82.53Zm-123.037-131.52 123.037 123.04 74.047-74.05-24.042-24.04-50.005 50-74.953-74.95 42.426-42.43 35.355 35.36 24.042-24.04-59.397-59.4-90.51 90.51ZM487.678 1360.14l-32.526-32.53 84.853-84.85-24.042-24.04-84.853 84.85-32.526-32.53 117.379-117.38 89.096 89.1-117.381 117.38Zm-24.042-32.53 24.042 24.04 108.895-108.89-80.611-80.61-108.895 108.89 24.042 24.05 84.853-84.86 32.526 32.53-84.852 84.85ZM131.725 1342.98 31.747 1243l99.978-99.98 32.527 32.53L96.8 1243l67.452 67.45-32.527 32.53ZM40.231 1243l91.493 91.49 24.043-24.04L88.315 1243l67.452-67.45-24.043-24.04L40.231 1243ZM954.835 1333.17l-98.995-99-63.64 63.64-32.526-32.52 96.166-96.17 98.995 98.99 63.645-63.63L1051 1237l-96.165 96.17Zm-98.995-107.48 98.995 98.99 87.685-87.68-24.04-24.04-63.645 63.64-98.995-99-87.682 87.69 24.042 24.04 63.64-63.64ZM1960.55 508.172l-32.53-32.527 117.38-117.379 32.53 32.527-117.38 117.379Zm-24.05-32.527 24.05 24.043 108.89-108.895-24.04-24.043-108.9 108.895Z"></path>
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="m2067.57 913.486-89.1-89.094 84.86-84.854-24.04-24.041-84.86 84.852-32.52-32.525 84.85-84.853-136.32-136.318 32.53-32.524L2011 622.161l52.33-52.327-56.57-56.568 32.53-32.526 89.09 89.095-84.85 84.853 24.04 24.042 84.85-84.854 32.53 32.527-84.85 84.854 24.04 24.041 84.85-84.853 32.53 32.528-117.38 117.378-28.29-28.283-52.32 52.327 56.57 56.568-32.53 32.523Zm-80.61-89.093 80.61 80.609 24.04-24.04-56.57-56.569 60.81-60.81 28.29 28.282 108.89-108.894-24.04-24.043-84.85 84.853-32.53-32.525 84.86-84.854-24.05-24.043-84.85 84.854-32.53-32.527 84.86-84.853-80.61-80.61-24.05 24.043 56.57 56.567-60.81 60.813-108.03-108.033-24.04 24.04 136.31 136.318-84.85 84.853 24.04 24.041 84.86-84.852 32.52 32.525-84.85 84.855ZM1992.59 370.57l-89.1-89.094 32.53-32.527 29.37 29.374 77.78-77.785 30.35 30.353-77.78 77.781 29.38 29.373-32.53 32.525Zm-80.61-89.092 80.61 80.608 24.04-24.041-29.37-29.373 77.78-77.781-21.87-21.867-77.78 77.783-29.37-29.373-24.04 24.044ZM2016.73-288.405l-99.98-99.979 99.98-99.979 32.52 32.526-67.45 67.452 67.45 67.452-32.52 32.528Zm-91.5-99.979 91.49 91.494 24.05-24.042-67.45-67.452 67.45-67.452-24.05-24.042-91.49 91.494ZM2071.74-478.199l-197.99-197.99-52.33 52.326 56.57 56.569-32.53 32.526-89.09-89.096 117.38-117.379 197.99 197.99 24.04-24.042-56.57-56.569 32.53-32.526 89.09 89.096-89.09 89.095Zm-197.99-206.475 197.99 197.99 80.61-80.61-80.61-80.611-24.05 24.042 56.57 56.569-32.52 32.526-197.99-197.99-108.9 108.895 80.61 80.611 24.04-24.042-56.56-56.569 60.81-60.811ZM533.362-497.417l-32.526-32.526 35.355-35.355-28.284-28.284 60.811-60.811 32.526 32.526-28.284 28.284 28.284 28.284-67.882 67.882Zm-24.042-32.526 24.042 24.042 59.397-59.397-28.284-28.284 28.284-28.284-24.042-24.042-52.326 52.326 28.284 28.284-35.355 35.355Z"></path>
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="m1842.18-413.489-60.81-60.812 32.53-32.526 28.28 28.284 59.32-59.316 53.74 53.739-32.53 32.526-21.21-21.213-59.32 59.318Zm-52.32-60.812 52.32 52.327 59.32-59.317 21.21 21.213 24.04-24.042-45.25-45.255-59.32 59.316-28.28-28.284-24.04 24.042ZM461.433 263.244l-32.526-32.525 28.284-28.285-93.61-93.61-56.568 56.569-32.526-32.526 89.095-89.096 158.663 158.663-60.812 60.81Zm-24.042-32.525 24.042 24.041 52.326-52.326L363.58 52.255l-80.61 80.611 24.042 24.042 56.568-56.569 102.095 102.095-28.284 28.285ZM794.842 731.529l-32.526-32.527 56.568-56.568-24.042-24.043-56.568 56.568-32.528-32.525 89.097-89.096L935.503 694l-32.526 32.527-51.566-51.568-56.569 56.57ZM770.8 699.002l24.042 24.043 56.568-56.57 51.566 51.568L927.019 694 794.842 561.822l-80.61 80.611 24.042 24.041 56.568-56.568 32.526 32.527-56.568 56.569ZM1434.86 405.213l-32.52-32.525 119.49-119.496-56.57-56.567 32.53-32.527 56.57 56.569 24.04-24.042-56.57-56.569 32.53-32.527 89.1 89.096-208.6 208.588Zm-24.04-32.525 24.04 24.041 200.11-200.106-80.61-80.611-24.04 24.043 56.57 56.568-32.53 32.527-56.57-56.569-24.04 24.042 56.57 56.568-119.5 119.497ZM909.215 465.195l-89.096-89.096L967.47 228.75l32.526 32.526-58.255 58.255 56.567 56.568-32.525 32.527-56.568-56.568-24.042 24.041 56.568 56.57-32.526 32.526ZM828.604 376.1l80.611 80.612 24.042-24.041-56.568-56.571 32.526-32.525 56.568 56.568 24.041-24.043-56.567-56.568 58.255-58.256-24.042-24.041L828.604 376.1ZM268.205 69.441 179.11-19.654l127.42-127.421 32.526 32.526-38.325 38.325 56.568 56.57-32.526 32.525-56.568-56.568-24.042 24.042 56.568 56.569-32.526 32.527Zm-80.61-89.094 80.61 80.61 24.042-24.042-56.568-56.568 32.526-32.526L324.773 4.39l24.042-24.042-56.568-56.569 38.325-38.325-24.042-24.043L187.595-19.653ZM1615.19-484.912l-96.18-96.178-42.42 42.426-32.53-32.526 42.43-42.427-24.05-24.042-42.42 42.427-32.53-32.526 74.95-74.953 185.28 185.274-32.53 32.525Zm-96.18-104.662 96.18 96.178 24.04-24.042-176.79-176.79-66.47 66.469 24.05 24.042 42.42-42.427 32.53 32.526-42.43 42.427 24.05 24.042 42.42-42.425ZM612.835-300.001l-32.526-32.526 85.524-85.525-24.042-24.042-85.525 85.524-32.526-32.526 118.052-118.051L815.739-333.2l-32.526 32.526-84.853-84.853-85.525 85.526Zm-24.042-32.526 24.042 24.042 85.524-85.525 84.853 84.853 24.042-24.042-165.463-165.464-109.567 109.566 24.042 24.042 85.525-85.525 32.526 32.526-85.524 85.527ZM482.67-124.906l-210.461-210.46 32.526-32.526 210.461 210.46-32.526 32.526Zm-201.977-210.46L482.67-133.391l24.042-24.042-201.977-201.975-24.042 24.042ZM-52.727-119.271l-32.526-32.526 117.38-117.379 32.525 32.526-117.379 117.379Zm-24.042-32.526 24.042 24.042L56.168-236.649l-24.042-24.042-108.895 108.894ZM1947.27-119.271l-32.52-32.526 117.38-117.379 32.52 32.526-117.38 117.379Zm-24.04-32.526 24.04 24.042 108.9-108.895-24.04-24.042-108.9 108.895ZM1818.53 1031.91l-32.52-32.53 78.73-78.734 32.53 32.527-78.74 78.737Zm-24.04-32.53 24.04 24.04 70.25-70.246-24.04-24.043-70.25 70.249ZM836.287 903.043 644.649 711.404l32.526-32.525 191.638 191.637-32.526 32.527ZM653.134 711.404l183.153 183.154 24.042-24.043-183.153-183.152-24.042 24.041ZM1921.65 906.249l-155.98-155.987 32.53-32.524 155.98 155.983-32.53 32.528Zm-147.5-155.987 147.5 147.503 24.05-24.044-147.5-147.5-24.05 24.041Z"></path>
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="m123.267 485.029-32.528-32.525 270.188-270.186 32.526 32.526-270.186 270.185Zm-24.042-32.525 24.042 24.041 261.701-261.7-24.042-24.042-261.7 261.701ZM919.479 1061.29l-32.526-32.53L1142.1 773.61l32.53 32.527-255.151 255.153Zm-24.041-32.53 24.042 24.04 246.66-246.663-24.04-24.043-246.662 246.666ZM1894.91 230.458 1720.96 56.51l32.53-32.527 173.95 173.949-32.53 32.526ZM1729.45 56.51l165.46 165.464 24.04-24.042-165.46-165.464-24.04 24.042ZM1716.99-3.812l-82.02-82.023 114.37-114.371 32.53 32.526-81.85 81.845 16.97 16.97 28.29-28.283 32.52 32.526-60.81 60.81Zm-73.53-82.023 73.53 73.54 52.33-52.327-24.04-24.042-28.29 28.284-25.45-25.455 81.84-81.845-24.04-24.042-105.88 105.887ZM1316.65 283.479l-146.28-146.285 114.37-114.37 32.52 32.526-81.84 81.844 81.23 81.233 28.29-28.284 32.52 32.526-60.81 60.81Zm-137.8-146.286 137.8 137.801 52.33-52.325-24.04-24.042-28.29 28.284-89.71-89.718 81.84-81.844-24.04-24.042-105.89 105.886ZM1537.6-53.405l-32.53-32.526 127.28-127.279-113.14-113.137 159.81-159.806 32.52 32.526-127.28 127.279 80.62 80.61 127.27-127.28 32.53 32.527L1537.6-53.405Zm-24.05-32.527 24.05 24.042 278.6-278.601-24.04-24.042-127.28 127.279-89.1-89.095 127.28-127.279-24.04-24.042-151.32 151.321 113.13 113.137-127.28 127.28ZM1644.12-597.624l-32.52-32.526 58.68-58.683-28.28-28.284 32.52-32.526 28.29 28.284 135.06-135.064-24.04-24.042-28.28 28.284-32.53-32.526 60.81-60.811 89.1 89.095-258.81 258.799Zm-24.04-32.526 24.04 24.042 250.32-250.315-80.61-80.61-52.33 52.326 24.04 24.042 28.29-28.284 32.52 32.526-143.54 143.548-28.29-28.284-24.04 24.042 28.28 28.284-58.68 58.683ZM1644.12 1402.38l-32.52-32.53 58.68-58.68-28.28-28.29 32.52-32.52 28.29 28.28 135.06-135.06-24.04-24.05-28.28 28.29-32.53-32.53 60.81-60.81 89.1 89.1-258.81 258.8Zm-24.04-32.53 24.04 24.04 250.32-250.31-80.61-80.61-52.33 52.32 24.04 24.05 28.29-28.29 32.52 32.53-143.54 143.55-28.29-28.29-24.04 24.04 28.28 28.29-58.68 58.68ZM354.954-141.745 251.717-244.982l32.526-32.526L387.48-174.271l-32.526 32.526Zm-94.753-103.237 94.753 94.753 24.042-24.042-94.753-94.753-24.042 24.042ZM954.835-541.731l-32.528-32.526 96.173-96.168 32.52 32.528-96.165 96.166Zm-24.043-32.527 24.043 24.042 87.685-87.682-24.04-24.042-87.688 87.682Z"></path>
                            <path fill="url(#leaderboard_intro_bg_svg__a)" fill-opacity="0.16" d="m1377.16 465.078-132.81-132.812 32.53-32.526 42.2 42.203 119.21-119.203 32.53 32.526-119.21 119.204 58.08 58.081-32.53 32.527Zm-124.32-132.812 124.32 124.328 24.05-24.042-58.08-58.081 119.2-119.205-24.04-24.041-119.21 119.203-42.2-42.203-24.04 24.041Z"></path>
                        </clipPath>
                    </defs>
                    <ellipse cx="0%" cy="24.69135802469136%" fill="url(#leaderboard_intro_bg_svg__b)" clip-path="url(#leaderboard_intro_bg_svg__c)" rx="450" ry="300"></ellipse>
                    <circle cx="50%" cy="50%" r="5000" fill="url(#leaderboard_intro_bg_svg__d)" clip-path="url(#leaderboard_intro_bg_svg__c)"></circle>
                </svg>

        {sorteo?.estado === 'oculto' ? (
          <Grid style={{ background: '#11111d', marginTop: isMobile ? '-30%' : '-10%', width: '100%' }}>
            <Grid
              style={{
                backgroundImage: `
                  linear-gradient(to bottom, rgba(63, 61, 69, 0.8), rgba(63, 61, 69, 0)),
                  url(${backgroundImg})
                `,
                backgroundSize: 'cover',
                backgroundRepeat: 'no-repeat',
                height: '980px',
                backgroundColor: '#3f3d45',
                margin: '0 auto',
                position: 'relative',
                backgroundPosition: '50%',
              }}
            >
              <Grid className="container" style={{ padding: 50, gap: '10px', justifyContent: 'center' }}>
                <Grid style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 15 }}>
                  <Typography style={{ color: 'white', fontWeight: 'bold', fontSize: '32px', fontFamily: 'Outfit,sans-serif' }}>
                    eldenguee.com
                  </Typography>
                  <Typography
                    sx={{
                      background: 'linear-gradient(317deg,#b58a1b 4.52%,#e0c060 34.37%,#ffeeb2 50.47%,#ffe77c 65.63%,#ffca41 110.56%)',
                      WebkitBackgroundClip: 'text',
                      WebkitTextFillColor: 'transparent',
                      fontWeight: 'bold',
                      fontSize: isMobile ? 32 : 65,
                      fontFamily: 'Belerofonte',
                    }}
                  >
                    El sorteo no existe
                  </Typography>
                </Grid>
              </Grid>
            </Grid>
          </Grid>
        ) : (
          <Box p={4} style={{ width: '85%', margin: '0 auto' }}>
            <Typography variant="h4" style={{ color: 'white' }}>
              {sorteo?.titulo}
            </Typography>
            <Typography variant="subtitle1" style={{ color: 'white' }}>
              Premios: {sorteo?.premios}
            </Typography>
            {!sorteo?.ganadores?.length && (
              <Button
                onClick={unirse}
                variant="contained"
                sx={{ mt: 2, backgroundColor: unirseSorteo && 'red', color: unirseSorteo && 'white' }}
              >
                {unirseSorteo ? 'YA ESTAS PARTICIPANDO' : 'PARTICIPAR'}
              </Button>
            )}
            {(usuarioKick === 'eldenguee' || usuarioKick === 'lucaslunacl') && (
              <Button onClick={sortear} variant="outlined" sx={{ mt: 2, ml: 2 }}>
                Sortear
              </Button>
            )}

            <Grid style={{ display: 'flex', alignItems: 'start', gap: '10px', marginBottom: '5%', zIndex: 9999 }}>
              <Card sx={{ mt: 4, width: '30%', border: '2px dashed #2a2e38' }}>
                <CardContent sx={{ maxHeight: 300, overflowY: 'auto' }}>
                  <Typography variant="h6">Participantes: {participantes?.length}</Typography>
                  <List>
                    {participantes?.map((u, i) => {
                      const { color, bonus } = getUserColor(userMessageCounts[u?.nombre] || 0);
                      return (
                        <ListItem key={i}>
                          <ListItemText
                            primary={
                              <span>
                                <span style={{ color }}>{u?.nombre}</span> (+{bonus}%)
                              </span>
                            }
                          />
                        </ListItem>
                      );
                    })}
                  </List>
                </CardContent>
              </Card>

              {sorteo?.ganadores?.length > 0 && (
                <Card sx={{ mt: 4, bgcolor: '#e0f7fa', width: '30%', border: '2px dashed #2a2e38' }}>
                  <CardContent>
                    <Typography variant="h6">🎉 Ganadores 🎉</Typography>
                    <List>
                      {JSON.parse(sorteo.ganadores).map((ganador, index) => (
                        <ListItem key={index}>
                          <Grid style={{ display: 'flex', alignItems: 'center', gap: 2 }}>
                            <Typography style={{ fontWeight: 'bold' }}>Puesto {index + 1}:</Typography>
                            <Typography>{ganador}</Typography>
                          </Grid>
                        </ListItem>
                      ))}
                    </List>
                  </CardContent>
                </Card>
              )}
            </Grid>
          </Box>
        )}

        <Modal open={open} onClose={() => setOpen(false)}>
          <AnimatePresence>
            {open && (
              <motion.div
                initial={{ x: -300, opacity: 0 }}
                animate={{ x: 0, opacity: 1 }}
                exit={{ x: -300, opacity: 0 }}
                transition={{ duration: 0.3 }}
                className="toast-container"
              >
                <div className="toast-content">
                  <div className="icon">🎉</div>
                  <div className="text">
                    <strong>{open && '¡Felicidades!'}</strong>
                    {open && <p>¡Ganaste un <strong>tipeo</strong>! 🎁</p>}
                  </div>
                  <button className="close-btn" onClick={() => setOpen(false)}>
                    ×
                  </button>
                </div>
                <div className={open ? 'progress-bar' : 'progress-bar-error'} style={{ width: `${progress}%` }} />
              </motion.div>
            )}
          </AnimatePresence>
        </Modal>
      </Grid>
    </Nlayout>
  );
}